<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Checkout - SYOS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/glass-morphism.css">
    <style>
        .checkout-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .floating-shapes {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }

        .shape {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 15s ease-in-out infinite;
        }

        .shape:nth-child(1) { width: 110px; height: 110px; top: 20%; left: 15%; animation-delay: 0s; }
        .shape:nth-child(2) { width: 140px; height: 140px; top: 65%; left: 75%; animation-delay: 5s; }
        .shape:nth-child(3) { width: 80px; height: 80px; top: 80%; left: 25%; animation-delay: 10s; }

        .payment-option {
            background: var(--glass-bg-light);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            transition: var(--transition-smooth);
            cursor: pointer;
        }

        .payment-option:hover {
            transform: translateY(-3px);
            border-color: rgba(67, 233, 123, 0.8);
            box-shadow: var(--glass-shadow);
        }

        .payment-option.selected {
            border-color: rgba(67, 233, 123, 1);
            background: var(--glass-bg);
        }

        .checkout-summary {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .order-item:last-child {
            border-bottom: none;
            font-weight: 600;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- Floating Background Shapes -->
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <div class="checkout-container fade-in">
        <div class="glass-form scale-in" style="width: 100%; max-width: 500px;">
            <!-- Header -->
            <div class="text-center mb-4">
                <div class="glass-icon" style="font-size: 2rem; margin: 0 auto 1rem; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    üõí
                </div>
                <h1 class="text-glass" style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;">Secure Checkout</h1>
                <p class="text-glass-muted" style="font-size: 0.9rem;">Complete your online order</p>
                <div class="glass-alert glass-alert-success mt-2" style="font-size: 0.8rem; padding: 0.5rem 1rem;">
                    <span>üîÑ</span>
                    <span>UPDATED: Card Payment Only</span>
                </div>
            </div>

            <!-- Error Message Display -->
            <div id="errorMessage" class="glass-alert glass-alert-error mb-3" style="display: none;">
                <span>‚ùå</span>
                <div>
                    <strong>Checkout Error</strong><br>
                    <span id="errorText"></span>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="checkout-summary">
                <h3 class="text-glass mb-3" style="font-weight: 600; font-size: 1.2rem;">üìã Order Summary</h3>
                <div id="orderItems">
                    <div class="order-item">
                        <span class="text-glass-muted">Sample Product 1</span>
                        <span class="text-glass">$29.99</span>
                    </div>
                    <div class="order-item">
                        <span class="text-glass-muted">Sample Product 2</span>
                        <span class="text-glass">$49.99</span>
                    </div>
                    <div class="order-item">
                        <span class="text-glass-muted">Shipping</span>
                        <span class="text-glass">Free</span>
                    </div>
                    <div class="order-item">
                        <span class="text-glass">Total Amount</span>
                        <span class="text-glass" id="totalAmount">$79.98</span>
                    </div>
                </div>
            </div>

            <form id="checkoutForm" method="post">
                <!-- Payment Method Selection -->
                <div class="glass-form-group">
                    <label class="glass-label">üí≥ Payment Method</label>

                    <div class="payment-option selected" onclick="selectPayment('CARD')">
                        <div style="display: flex; align-items: center;">
                            <input type="radio" name="paymentMethod" value="CARD" required style="margin-right: 1rem;" checked>
                            <div>
                                <div class="text-glass" style="font-weight: 600; font-size: 1.1rem;">üí≥ Credit/Debit Card</div>
                                <div class="text-glass-muted" style="font-size: 0.85rem;">Secure online card payment</div>
                            </div>
                        </div>
                    </div>

                    <div class="glass-alert glass-alert-success mt-2" style="font-size: 0.75rem;">
                        <span>üí°</span>
                        <span>Online customers use card payments only. Cash payments are available at POS terminals.</span>
                    </div>
                </div>

                <!-- Card Details (Mock UI) -->
                <div id="cardDetails" class="glass-form-group">
                    <label class="glass-label">üíé Card Information</label>
                    <div style="display: grid; gap: 1rem;">
                        <input type="text" class="glass-input" placeholder="Card Number" maxlength="19">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <input type="text" class="glass-input" placeholder="MM/YY" maxlength="5">
                            <input type="text" class="glass-input" placeholder="CVC" maxlength="3">
                        </div>
                        <input type="text" class="glass-input" placeholder="Cardholder Name">
                    </div>
                </div>

                <!-- Checkout Button -->
                <button type="submit" class="glass-btn glass-btn-success" style="width: 100%; justify-content: center; padding: 1rem; font-size: 1.1rem;">
                    <span>‚úÖ Confirm & Pay $<span id="payAmount">79.98</span></span>
                </button>
            </form>

            <!-- Additional Options -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
                <a href="cart/view" class="glass-btn glass-btn-secondary" style="text-decoration: none; justify-content: center;">
                    <span>üõí Back to Cart</span>
                </a>
                <a href="store-home.html" class="glass-btn glass-btn-primary" style="text-decoration: none; justify-content: center;">
                    <span>üè™ Continue Shopping</span>
                </a>
            </div>

            <!-- Security Notice -->
            <div class="glass-alert glass-alert-success mt-3" style="font-size: 0.75rem;">
                <span>üîí</span>
                <div>
                    <strong>Secure Payment:</strong> Your payment information is encrypted and secure. We never store your card details.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get context path dynamically
        const contextPath = window.location.pathname.substring(0, window.location.pathname.indexOf('/', 1)) || '';

        // Set form action
        document.getElementById('checkoutForm').action = contextPath + '/checkout';

        // Payment method selection
        function selectPayment(method) {
            const options = document.querySelectorAll('.payment-option');
            options.forEach(option => option.classList.remove('selected'));

            event.currentTarget.classList.add('selected');
            document.querySelector(`input[value="${method}"]`).checked = true;
        }

        // Form submission with loading state
        document.getElementById('checkoutForm').addEventListener('submit', function(e) {
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;

            submitBtn.innerHTML = '<span class="glass-loading"></span> <span>Processing Payment...</span>';
            submitBtn.disabled = true;

            // Show processing notification
            showNotification('Processing your payment...', 'warning');

            // Simulate payment processing
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }, 5000);
        });

        // Card number formatting
        const cardNumberInput = document.querySelector('input[placeholder="Card Number"]');
        cardNumberInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{4})(?=\d)/g, '$1 ');
            e.target.value = value;
        });

        // Expiry date formatting
        const expiryInput = document.querySelector('input[placeholder="MM/YY"]');
        expiryInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            e.target.value = value;
        });

        // CVC validation
        const cvcInput = document.querySelector('input[placeholder="CVC"]');
        cvcInput.addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '');
        });

        // Show error message function
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            errorText.textContent = message;
            errorDiv.style.display = 'flex';

            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        // Show notification
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `glass-alert glass-alert-${type}`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '250px';
            notification.innerHTML = `<span>${message}</span>`;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Load cart data (simulated)
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate loading cart data
            updateOrderSummary();
        });

        function updateOrderSummary() {
            // This would normally fetch from your cart API
            const items = [
                { name: 'Sample Product 1', price: 29.99 },
                { name: 'Sample Product 2', price: 49.99 }
            ];

            let total = items.reduce((sum, item) => sum + item.price, 0);

            document.getElementById('totalAmount').textContent = '$' + total.toFixed(2);
            document.getElementById('payAmount').textContent = total.toFixed(2);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                window.location.href = 'cart/view';
            }
        });
    </script>
</body>
</html>
